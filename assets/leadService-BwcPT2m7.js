const d="klyora_leads",s=()=>{const e=localStorage.getItem(d);return e?JSON.parse(e):[]},l={saveLead:(e,a)=>{const o=s(),t={id:Math.random().toString(36).substr(2,9),type:e,data:a,timestamp:new Date().toISOString()};o.push(t),localStorage.setItem(d,JSON.stringify(o)),console.log(`[LeadService] Saved ${e} lead`,t)},getAllLeads:()=>s(),getLeadsByType:e=>s().filter(a=>a.type===e),downloadLeads:()=>{const e=s();if(e.length===0){alert("No leads collected yet.");return}const a=`data:text/csv;charset=utf-8,ID,Type,Timestamp,Data
`+e.map(n=>`${n.id},${n.type},${n.timestamp},${JSON.stringify(n.data).replace(/,/g,";")}`).join(`
`),o=encodeURI(a),t=document.createElement("a");t.setAttribute("href",o),t.setAttribute("download",`klyora_leads_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(t),t.click(),document.body.removeChild(t)},clearLeads:()=>{confirm("Are you sure you want to delete all local leads? This cannot be undone.")&&(localStorage.removeItem(d),window.location.reload())}};export{l};
